(this["webpackJsonphermione-profiler-ui"]=this["webpackJsonphermione-profiler-ui"]||[]).push([[0],{173:function(e,t,a){e.exports={pluginsCollapse:"Events_pluginsCollapse__L7his",pluginsDiagramContaner:"Events_pluginsDiagramContaner__1dkYW",pluginsDiagramWrapper:"Events_pluginsDiagramWrapper__1wnF0",events:"Events_events__3XJV4"}},177:function(e,t,a){e.exports={container:"Main_container__1ZgYJ",contentContainer:"Main_contentContainer__36h-v",rightLayout:"Main_rightLayout__2fsER",content:"Main_content__1GxDW",footer:"Main_footer__E703A"}},365:function(e,t,a){e.exports={loader:"Loader_loader__2DkXo"}},410:function(e,t,a){},502:function(e,t,a){"use strict";a.r(t);var n,r=a(1),o=a(54),i=a.n(o),c=(a(410),a(282)),s=a(57),l=a(97),u=a(361),d=a.n(u),p=a(143),f=a(516),m=a(517),b=a(366),j=a(509),h=a(390),g=a(507),v=a(148),O=a(362),x=a.n(O),y=a(28),k=a.n(y),w=a(65),S=a(285),N=a(92),E=["startRunner","endRunner","init"],_=function(e){return k.a.chain(e).maxBy("end").get("end",0).value()-k.a.chain(e).minBy("start").get("start").value()};function I(e){return function(e){var t=function(e){var t=k.a.groupBy(e,"listenerName");return k.a.mapValues(t,P)}(e);return{list:k.a.keys(t),map:t}}(e)}function P(e){var t=function(e){var t=k.a.groupBy(e,"event");return k.a.mapValues(t,L)}(e);return{list:k.a.values(t).map((function(e){var t=e.list,a=Object(l.a)(t,1)[0],n=k.a.maxBy(t,"duration");return{duration:(null===n||void 0===n?void 0:n.duration)||0,numberOfProcesses:t.length,event:a.event,listenerName:a.listenerName,pid:a.pid,filePath:a.filePath,calls:k.a.get(n,"calls",0),worker:a.worker,waitable:a.waitable}})),map:t}}function L(e){var t=function(e){var t=k.a.groupBy(e,(function(e){var t=e.filePath,a=e.pid;return"".concat(t,":").concat(a)}));return k.a.mapValues(t,C)}(e);return{list:k.a.values(t).map((function(e){var t=e.list,a=e.map,n=Object(l.a)(t,1)[0];return{duration:n.waitable?_(k.a.values(a)):k.a.sumBy(t,"duration"),pid:n.pid,event:n.event,filePath:n.filePath,listenerName:n.listenerName,worker:n.worker,calls:k.a.sumBy(t,"calls"),waitable:n.waitable}})),map:t}}function C(e){return{list:B(e),map:T(e)}}function B(e){var t=k.a.groupBy(e,"pluginName"),a=k.a.mapValues(t,(function(e){var t,a=Object(l.a)(e,1)[0],n=(t=a.event,E.includes(t));return{duration:n?_(e):k.a.sumBy(e,"duration"),calls:e.length,pluginName:a.pluginName,pid:a.pid,filePath:a.filePath,listenerName:a.listenerName,event:a.event,worker:a.worker,waitable:n}}));return k.a.values(a)}function T(e){var t,a=k.a.groupBy(e,"pluginName"),n=(null===(t=k.a.minBy(e,"start"))||void 0===t?void 0:t.start)||0,r=k.a.mapValues(a,(function(e){return k.a.orderBy(e,"start").map((function(e,t){return Object(w.a)(Object(w.a)({},e),{},{title:"".concat(e.pluginName," (").concat(t+1,")"),range:[e.start-n,e.end-n]})}))})),o=k.a.chain(r).values().flatten().groupBy("title").value();return k.a.mapValues(o,(function(e){return Object(l.a)(e,1)[0]||{}}))}!function(e){e.empty="empty",e.loading="loading",e.loaded="loaded",e.error="error"}(n||(n={}));var R,U,M=Object(S.a)({sources:[],items:[],loadState:n.empty,map:{}}),A=function(){var e=Object(S.b)(M);e.attach(N.a);var t=function(t){var a=e.sources.find((function(e){return e.filePath.get()===t}));if(!a)throw new Error('Unable to fine source="'.concat(t,'" in store'));return a};return{state:function(){return e},setLoadingState:function(){e.loadState.set(n.loading)},setLoadedState:function(){e.loadState.set(n.loaded)},isLoaded:function(){return e.loadState.get()===n.loaded},isLoading:function(){return e.loadState.get()===n.loading},isAllSourcesLoaded:function(){return e.sources.every((function(e){return[n.error,n.loaded].includes(e.loadState.get())}))},addUntrackedSource:function(t){Object(N.a)(e.sources).merge([{rowsCount:0,filePath:t,fetchError:null,loadState:n.empty}])},setUntrackedLoadingSourceState:function(e){var a=t(e);Object(N.a)(a.loadState).set(n.loading)},setUntrackedErrorSourceState:function(e,a){var r=t(e);Object(N.a)(r.loadState).set(n.error),Object(N.a)(r.fetchError).set(a)},getErrors:function(){return e.sources.filter((function(e){return!k.a.isEmpty(e.fetchError)})).map((function(e){return{filePath:e.filePath.get(),error:e.fetchError.get()}}))},setUntrackedCompleteSourceState:function(e){var a=t(e);Object(N.a)(a.loadState).set(n.loaded)},addUntrackedItems:function(a,n){var r=t(a),o=n.map((function(e){return Object(w.a)(Object(w.a)({},e),{},{filePath:a})}));Object(N.a)(e.items).merge(o),Object(N.a)(r.rowsCount).set((function(e){return e+n.length}))},getSources:function(){return e.sources.get()},shouldFetch:function(){return e.loadState.get()===n.empty},buildMap:function(){var t=I(Object(N.a)(e.items).get());Object(N.a)(e.map).set(t)},getMap:function(){return Object(N.a)(e.map).get()}}},D=a(363),W=a.n(D),F=a(364),V=a.n(F);(U=R||(R={})).chunk="chunk",U.error="error",U.complete="complete",U.start="start";var z=a(365),K=a.n(z),q=a(18),J=function(){return Object(q.jsx)("div",{className:K.a.loader,children:Object(q.jsx)(b.a,{size:"large"})})},X=a(109),Y=a(515),G=a(510),H=a(514),Z=a(511),Q=a(508),$=function(e){var t=k.a.chain(e.data).map("duration").max().value(),a=e.data.map((function(e){return Object(w.a)(Object(w.a)({},e),{},{key:e.event,processes:e.numberOfProcesses})})),n=[{title:"Event",dataIndex:"event",key:"event"},{title:"Number of processes",dataIndex:"numberOfProcesses",key:"numberOfProcesses"},{title:"Number of calls",dataIndex:"calls",key:"calls"},{title:"Type",dataIndex:"waitable",key:"waitable",align:"center",render:function(e){var t=e?["WAITABLE","green"]:["NON_WAITABLE","geekblue"],a=Object(l.a)(t,2),n=a[0],r=a[1];return Object(q.jsx)(H.a,{color:r,children:n.toUpperCase()},n)}},{width:"50%",title:"Max by process duration",dataIndex:"duration",key:"duration",render:function(e){var a=100/t*e-1;return Object(q.jsx)(Z.a,{percent:a,strokeWidth:25,strokeLinecap:"square",format:function(){return"".concat(e," ms")}})}}];return Object(q.jsx)("div",{children:Object(q.jsx)(Q.a,{bordered:!0,pagination:!1,size:"small",columns:n,dataSource:k.a.chain(a).sortBy("duration").reverse().value(),expandable:{expandedRowRender:e.drawNestedTable}})})},ee=a(512),te=a(513),ae=a(173),ne=a.n(ae),re=function(e){var t=k()(e.data).values().orderBy("start").map((function(e){return{value:e.range,label:e.title,duration:e.duration}})).value(),a={height:e.height,autoFit:!1,renderer:"svg",data:t,isRange:!0,xField:"value",yField:"label",color:"#1c90ff",tooltip:!1,barStyle:{stroke:"#1c90ff",lineWidth:1},xAxis:{label:{formatter:function(e){return"".concat(e/1e3,"sec / ").concat(Math.round(e/1e3/60),"min")}}},label:{content:function(e){return"".concat(e.duration," ms")},position:"right",layout:[{type:"adjust-color"}]}};return e.scroll&&(a.scrollbar={type:"vertical",width:10,categorySize:30,animate:!1}),Object(q.jsx)(ee.a,Object(w.a)({},a))},oe=function(e){var t=k.a.chain(e.data).map("duration").max().value(),a=k.a.chain(e.data).first().get("waitable").value(),n=e.data.map((function(e){return Object(w.a)(Object(w.a)({},e),{},{key:e.pluginName})})),r=30*k.a.values(e.map).length,o=r>500,i=o?500:r,c=[{title:"Plugin name",dataIndex:"pluginName",key:"pluginName"},{title:"Number of calls",dataIndex:"calls",key:"calls"},{width:"50%",title:a?"Range between start and end of all calls":"Sum duration of plugin calls",key:"duration",dataIndex:"duration",render:function(e){var a=100/t*e-1;return Object(q.jsx)(Z.a,{percent:a,strokeWidth:25,strokeLinecap:"square",format:function(){return"".concat(e," ms")}})}}];return Object(q.jsxs)("div",{children:[Object(q.jsx)(Q.a,{bordered:!0,pagination:!1,size:"small",columns:c,dataSource:k.a.sortBy(n,"duration").reverse()}),Object(q.jsx)(te.a,{className:ne.a.pluginsCollapse,children:Object(q.jsx)(te.a.Panel,{header:"Timeline diagram",children:Object(q.jsx)("div",{className:ne.a.pluginsDiagramWrapper,style:{height:i},children:Object(q.jsx)("div",{className:ne.a.pluginsDiagramContaner,children:Object(q.jsx)(re,{data:e.map,height:i,scroll:o})})})},"diagram")})]})},ie=function(e){var t=k.a.chain(e.data).map("duration").max().value(),a=k.a.chain(e.data).first().get("waitable").value(),n=e.data.map((function(e){return Object(w.a)(Object(w.a)({},e),{},{key:"".concat(e.filePath,":").concat(e.pid),type:e.worker?"worker":"master"})})),r=[{title:"File",dataIndex:"filePath",key:"filePath"},{title:"PID",dataIndex:"pid",key:"pid"},{title:"Number of calls",dataIndex:"calls",key:"calls"},{title:"Type",dataIndex:"type",key:"type",align:"center",render:function(e){var t="master"===e?"green":"geekblue";return Object(q.jsx)(H.a,{color:t,children:e.toUpperCase()},e)}},{width:"50%",title:a?"Range between start and end of all plugins":"Sum duration of plugins",dataIndex:"duration",key:"duration",render:function(e){var a=100/t*e-1;return Object(q.jsx)(Z.a,{percent:a,strokeWidth:25,strokeLinecap:"square",format:function(){return"".concat(e," ms")}})}}];return Object(q.jsx)("div",{children:Object(q.jsx)(Q.a,{bordered:!0,pagination:{pageSize:50},size:"small",columns:r,dataSource:k.a.chain(n).sortBy("duration").reverse().value(),expandable:{expandedRowRender:e.drawNestedTable}})})},ce={Events:function(){var e=A().getMap();return k.a.isEmpty(e)?Object(q.jsx)(j.a.Text,{type:"danger",children:"Nothing to show"}):Object(q.jsx)("div",{className:ne.a.events,children:e.list.map((function(t){var a=e.map[t];return Object(q.jsxs)("div",{children:[Object(q.jsx)(G.a,{title:t,subTitle:"(listener)"}),Object(q.jsx)($,{data:a.list,drawNestedTable:function(e){var t=a.map[e.event];return Object(q.jsx)(ie,{data:t.list,drawNestedTable:function(e){var a=t.map["".concat(e.filePath,":").concat(e.pid)];return Object(q.jsx)(oe,{data:a.list,map:a.map,drawNestedTable:function(e){return Object(q.jsx)("div",{children:"KEK"})}})}})}})]},t)}))})}},se=[{title:"Plugins",Icon:Y.a,subItems:[{title:"Events",path:"/plugins/events",Component:ce.Events}]}],le=se[0],ue=Object(l.a)(le.subItems,1)[0].path,de=[le.title],pe=[ue],fe=k.a.chain(se).map("subItems").flatten().value(),me=X.a.SubMenu,be=Object(s.g)((function(e){var t=e.history;return Object(q.jsx)(X.a,{theme:"dark",defaultSelectedKeys:pe,selectedKeys:[t.location.pathname],defaultOpenKeys:de,mode:"inline",children:se.map((function(e){var a=e.Icon,n=e.title,r=e.subItems;return Object(q.jsx)(me,{icon:Object(q.jsx)(a,{}),title:n,children:r.map((function(e){var a=e.title,n=e.path;return Object(q.jsx)(X.a.Item,{onClick:function(){return t.push(n)},children:a},n)}))},n)}))})})),je=a(177),he=a.n(je),ge=g.a.Content,ve=g.a.Footer,Oe=g.a.Sider,xe=window.HERMIONE_PROFILER_FILES_DECLARATION,ye=Object(y.uniq)(xe.plugins),ke="loader-progress",we=function(e){var t=x.a.delay(1e3),a=Object(r.useState)(!1),n=Object(l.a)(a,2),o=n[0],i=n[1],c=A(),s=function(){var e=c.getSources().map((function(e){var t={loading:Object(q.jsx)(p.a,{twoToneColor:"blue"}),empty:Object(q.jsx)(p.a,{}),loaded:Object(q.jsx)(f.a,{twoToneColor:"#52c41a"}),error:Object(q.jsx)(m.a,{twoToneColor:"red"})}[e.loadState];return Object(q.jsxs)("div",{children:[Object(q.jsx)(b.a,{indicator:t})," Loading"," ",Object(q.jsx)(j.a.Text,{strong:!0,children:d.a.basename(e.filePath)})," ","/ ",e.rowsCount," rows"]},e.filePath)}));t=t.delay(10).then((function(){h.a.open({description:e,message:"Downloads:",duration:0,key:ke})}))},u=function(){t.delay(1e3).then((function(){h.a.close(ke)})).then((function(){c.buildMap(),c.setLoadedState()}))};Object(r.useEffect)((function(){c.shouldFetch()&&(c.setLoadingState(),ye.forEach((function(e){c.addUntrackedSource(e),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,a=new W.a,n=V()(e),r=!1,o=[],i=function(){a.emit(R.chunk,o.concat()),o=[]};return n.node("root.*",(function(e){o.push(e),o.length===t&&i()})).on("start",(function(){return a.emit(R.start)})).fail((function(e){var t,n=e.body||(null===(t=e.thrown)||void 0===t?void 0:t.message)||String(e);a.emit("error",n),r=!0})).done((function(){o.length>0&&i(),r||a.emit(R.complete)})),a}(e).on("chunk",(function(t){c.addUntrackedItems(e,t),s()})).on("start",(function(){c.setUntrackedLoadingSourceState(e),s()})).on("error",(function(t){c.setUntrackedErrorSourceState(e,t),s(),c.isAllSourcesLoaded()&&u()})).on("complete",(function(){c.setUntrackedCompleteSourceState(e),s(),c.isAllSourcesLoaded()&&u()}))})))}));var O=c.getErrors();k.a.isEmpty(O)||(console.error("Unable to load files:",O),O.forEach((function(e){var t=e.filePath,a=e.error;h.a.error({message:t,description:a,placement:"topRight",key:t})})));var y=c.isLoading()?Object(q.jsx)(J,{}):e.children;return Object(q.jsxs)(g.a,{className:he.a.container,children:[Object(q.jsx)(Oe,{collapsible:!0,collapsed:o,onCollapse:function(){return i(!o)},children:Object(q.jsx)(be,{})}),Object(q.jsxs)(g.a,{className:he.a.rightLayout,children:[Object(q.jsx)(ge,{className:he.a.contentContainer,children:Object(q.jsx)("div",{className:he.a.content,children:y})}),Object(q.jsx)(ve,{className:he.a.footer,children:Object(q.jsx)(v.a,{type:"link",href:"https://github.com/gemini-testing/hermione",children:"Profiler for hermione"})})]})]})},Se=function(){return Object(q.jsx)(c.a,{children:Object(q.jsx)(we,{children:Object(q.jsxs)(s.d,{children:[Object(q.jsx)(s.b,{exact:!0,path:"/",render:function(){return Object(q.jsx)(s.a,{to:ue})}}),fe.map((function(e){var t=e.path,a=e.Component;return Object(q.jsx)(s.b,{path:t,component:a},t)}))]})})})};i.a.render(Object(q.jsx)(Se,{}),document.getElementById("root"))}},[[502,1,2]]]);
//# sourceMappingURL=main.a51b3f02.chunk.js.map